## 09 - (링크상태, 경로벡터)라우팅과 멀티 캐스팅

### 1) 링크상태 라우팅과 경로벡터 라우팅

#### 링크상태 라우팅 (Link State Routing)

- **모든 노드가 전체 네트워크에 대한 구성도를 만들어서** 경로를 구함
  - 각 노드는 다른 모든 노드로부터 최단 경로를 구함 (거리벡터는 이웃노드하고만 주고받음)
  - 각 노드는 **Dijkstra's 최단 경로 알고리즘**을 사용하여 라우팅 테이블을 구축
  - 네트워크에 변화 즉, 링크상태가 바뀌면 각 노드는 네트워크 구성도 갱신

- **OSPF (Open Shortest Path First) 라우팅 프로토콜**은 링크 상태 라우팅 방법을 사용

- 알고리즘
  - 각 라우터는 인터넷 전체 그림을 그려야 함 
    - 이웃에 관한 정보를 공유
    - 모든 라우터와 공유
    - 변화가 발생하면 정보를 공유

- 정보 전송 방식: **Flooding**

  - 패킷이 들어온 곳을 제외하고 나머지 모든 포트를 통해 정보를 보냄

  - 장점: 단기간 내에 정보를 전체에 전달하는데 매우 효과적
    단점: 중복해서 받는 경우가 생김

    

- 저장소: **링크상태 데이터베이스**
  - 모든 라우터가 링크상태 데이터베이스를 가지고 있다.
  - 모든 토폴로지 정보를 가지고 있으며, 이를 이용해 네트워크 맵을 그릴 수 있다.



#### 경로벡터 라우팅 (Path Vector Routing)

- **BGP(Border Gateway Protocol)**은 **자율 시스템 간의** 라우팅 프로토콜
  - 현재 사용되는 버전은 BGP4
  - **경로벡터 라우팅 방법**을 사용
  - 라우팅 테이블에 목적지까지의 경로가 명시
  - **경로는 자율 시스템의 리스트**로 표현
- **도메인과 도메인 사이에서 사용하는 라우팅 방법**
  - **도메인 내에서는 거리벡터나 링크상태 라우팅 방법 사용**

- **Loop Prevention (루프 방지)**
  - 데이터 수신 시 라우터가 자신의 자율 시스템이 목적지 경로 항목에 있는지 확인
  - 만약 포함되어 있으면 Loop에 포함됐으므로 해당 데이터 무시
- **Policy Routing (정책 라우팅)**
  - 경로 벡터 라우팅을 통해 쉽게 구현 가능
  - 데이터 수신 시 라우터는 경로를 확인 가능
  - 경로 확인 시 등록된 자율시스템 중 일부가 정책에 반대되면 그 경로와 목적지를 무시



### 2) 멀티캐스팅

#### 멀티 캐스팅

- 1:n 의 관계 (1:1은 유니캐스팅, 1:all은 브로드캐스팅)



#### 멀티캐스트 그룹 관리

- **IGMP (Internet Group Management Protocol)**
  - **그룹에 속한 시스템들의 가입과 탈퇴**를 관리

- 멀티캐스트 라우터에게 그룹에 속한 시스템들에 대한 정보를 제공
  - 멀티캐스팅 라우팅 프로토콜이 아니라 **그룹에 대한 관리만 담당**
- IGMP는 로컬에서 작동
  - 라우터 안에 라우터가 관리하는 내부의 여러 컴퓨터들이 있고, 그룹 가입 여부를 라우터가 파악하여 패킷을 전송할지 판단함.
    보통 라우터와 말단에 있는 컴퓨터 사이에는 IGMP가 동작한다고 생각하면 된다.

- IGMP 메시지
  - query message: 라우터가 특정 멀티캐스트 그룹이 존재하는지 확인할 경우 사용
  - report message: 호스트의 쿼리 메시지에 대한 응답(참여하고 있음을 알림, 응답하지 않으면 라우터 데이터베이스에서 제거)



#### 멀티캐스트 라우팅

- 멀티캐스트 라우팅에서는 라우터가 각 그룹에 대한 하나의 최적 경로를 가짐

  - N개의 그룹이 있다면, N개의 최적 경로가 필요
  - 그룹에 소속된 네트워크가 여러개 존재
  - 트리를 구성하여 멀티캐스트 패킷을 전달

- 멀티캐스팅 라우팅 종류

  <img src="https://user-images.githubusercontent.com/70627979/150089339-0d2c892f-63c4-4051-bfff-da70d033b911.png" alt="image" style="zoom:67%;" />

  - **송신자 기반 트리 (Source-based tree)**

    - 트리의 구성이 송신자와 그룹을 이용하여 구성 (각 라우터는 그룹별로 하나의 최적 경로를 구함)
    - 종류
      - DVMRP (Distance Vector Multicast Routing Protocol): RIP와 같은 거리벡터 라우팅 방식을 확장
      - MOSPF (Multicast OSPF): OSPF와 같은 링크 상태 라우팅 방식 확장
      - PIM-DM (Protocol Independent Multicast-Dense Mode): RIP나 OSPF를 사용

    <img src="https://user-images.githubusercontent.com/70627979/150089899-ffdcace0-5e88-4928-ae5b-e9c2e0092d3d.png" alt="image" style="zoom:67%;" />

  - **그룹 공유 트리 (Group-shared tree)**

    - 각 라우터가 그룹 별로 최적 경로를 구하지 않고, 센터 코어(center core) 혹은 랑데부 라우터만 그룹에 대한 최적 경로를 구성

    - 동일한 트리를 각 그룹이 하나씩 가지며 이를 공유

    - 종류

      - CBT (Core-Based Tree)
      - PIM-SM(Sparse-Mode)

      <img src="https://user-images.githubusercontent.com/70627979/150090346-f553ed89-64b2-4560-83c2-0f601103d07c.png" alt="image" style="zoom:67%;" />

  
