## 08 - 패킷 전달과 거리벡터 라우팅

### 1) 패킷의 전달

#### 패킷의 처리

- **송신자**의 **네트워크 계층은 패킷을 생성**
  - 패킷이 너무 크면 **단편화**가 발생 (단편화: 패킷 분할, fragmentation)
  - 목적지에 패킷을 전달하기 위해 **라우팅 테이블**을 참조

- **수신자**(목적지)의 **네트워크 계층은 주소를 확인**하여 자신에게 온 패킷인지 검사
  - IP 패킷의 헤더들을 검사
  - 단편화된 패킷을 받으면, 단편들을 모아 하나의 온전한 패킷으로 조합
- 스위치나 라우터와 같은 **중간 장치들은 패킷을 라우팅**
  - 패킷이 도착하면 라우팅 테이블을 검사하고 보내야 하는 인터페이스를 확인

- 패킷의 전달은 직접 전달과 간접 전달로 나뉨
  - **직접 전달(direct delivery)**: 패킷의 최종목적지가 전달자와 동일한 네트워크 상에 있을 경우
  - **간접 전달(indirect delivery)**: 패킷이 최종목적지에 전달될 때까지 라우터에서 라우터로 전달



#### 패킷의 전달

- 전달 방법
  - **이웃 노드 명시 (Next-hop method)**
    - 라우팅 테이블은 전체 경로상의 라우터를 명시하지 않고 **다음 라우터만을 명시**
    - A -> R1 -> R2 -> B 와 같이 모든 경로를 명시하는게 아닌, A는 R1만 명시하는 것
  - **네트워크 주소 명시 (Network-specific method, 일반적)**
    - 동일한 네트워크에 연결된 컴퓨터들을 모두 명시하는게 아닌, **목적지 네트워크 주소만 명시**
    -  호스트 파트를 보지 않고 네트워크 파트만 보고 라우팅 테이블을 명시 가능
  - 호스트 주소 명시 (Host-specific method)
    - 흔치 않지만 라우팅 테이블에 목적지 컴퓨터 주소를 직접 명시 가능
    - 비효율적이나 특별한 목적이 있는 경우 포함 가능 (우선권을 가짐)
  - 디폴트 지정 (Default method)
    - 인터넷에 있는 모든 목적지를 지정할 수 없으므로 지정된 목적지 이외의 모든 지역을 지정하는 라우팅 엔트리를 디폴트라고 함
    - ex) PC방에서 외부로 나가는 라우터는 모두 동일하므로 해당 라우터를 디폴트로 지정



### 2) 라우팅 프로토콜과 거리벡터 라우팅

#### 라우팅 테이블과 라우팅 프로토콜

- 라우팅은 패킷을 전달하기 위한 경로를 선택하는 과정
- **라우팅 테이블**
  - 정적 라우팅(static routing) 테이블은 직접 입력
    - 자동으로 갱신x, 보통 호스트 컴퓨터에서 사용
  - **동적 라우팅(dynamic routing) 테이블**은 경로를 주기적으로 갱신
    - 대표적으로 RIP, OSPF, BGP가 존재

- **라우팅 프로토콜**
  - **유니캐스트 라우팅 프로토콜**
    - 일반적인 라우팅 프로토콜로 **목적지가 하나**
    - 경로를 선택하기 위해 **어떻게 라우팅 정보를 교환하여 라우팅 테이블을 구축할 것인지를 명시**
    - 송수인이 모두 하나의 시스템
  - **멀티캐스트 라우팅 프로토콜**
    - **목적지가 동일 그룹에 속한 여러 호스트**가 될 수 있음

- **자율 시스템 (AS: Autonomous System)**

  - 하나의 라우팅 프로토콜이 전체 인터넷에서 통용되지 않음

  - **AS는 하나의 기관 내부를 나타낸 것으로 네트워크와 라우터의 집합**으로 구성

  - 번호가 같은 라우터끼리만 라우팅 정보를 주고받는 방식

  - 라우팅 프로토콜은 **내부 게이트웨이 프로토콜(AS내부)과 외부 게이트웨이 프로토콜(AS끼리)로 구분**

    - 내부 게이트웨이 프로토콜 (interior gateway protocol: IGP)

      : 자율 시스템 내부에서 사용되는 라우팅 프로토콜 (IS-IS, OSPF, IGRP, EIGRP, RIP 등)

    - 외부 게이트웨이 프로토콜 (exterior gateway protocol: EGP)

      : 자율 시스템 간에 사용되는 라우팅 프로토콜 (BGP)

  - 각 AS는 하나 또는 여러 개의 라우팅 프로토콜을 사용할 수 있지만, AS간에는 반드시 하나의 라우팅 프로토콜만 사용 가능하다.

    <img src="https://user-images.githubusercontent.com/70627979/149894894-ce8f06b9-f14f-4820-944d-2a608850520e.png" alt="image" style="zoom:67%;" />



#### 거리 벡터 라우팅 (Distance Vector Routing)

- 두 노드 사이의 최소 비용 경로는 최소 거리를 갖는 경로
  - 경로를 계산하기 위해 Bellman-Ford 알고리즘을 사용
- 거리 벡터 라우팅을 사용하는 프로토콜로 RIP, IGRP 등이 존재 (BGP도 유사)
- 알고리즘
  - 각 라우터는 자신의 정보를 이웃 라우터와 공유
    - 자기 주변 정보 습득 후, 이를 기반으로 목적지까지의 최적 경로 판단
