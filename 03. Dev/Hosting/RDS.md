# RDS

RDS는 AWS에서 제공하는 관계형 데이터베이스의 설치, 운영, 관리를 지원하는 서비스이다.

안정적인 데이터베이스의 관리 및 배포를 위해 프로젝트에서 AWS의 RDS를 사용하였다.



## RDS 생성

아래 항목들은 RDS에서 MySQL의 데이터베이스를 만들 때 설정하는 옵션들이다. 그리고 설정값들은 비용을 최소화하기 위한 선택값이니 필요에 따라 변경하여 사용하면 된다.

#### 설정

- **데이터베이스 생성 방식 선택**: 표준 생성

- **엔진 옵션 MySQL**: MySQL (최신 버전)

- **템플릿**: 프리 티어

- **DB 인스턴스 식별자**: [your-choice] (AWS에서 DB구분하기 위함)

- **마스터 사용자 이름**: [your-choice] (기본값은 admin으로 되어있으며, 변경해도 괜찮다)

- **마스터 암호**: [your-choice]



#### DB 인스턴스 클래스

- **DB 인스턴스 클래스**: 버스터블 클래스 (db.t2.micro)



#### 스토리지

- **스토리지 유형**: 범용 SSD(gp2)

- **할당된 스토리지**: 20

- **스토리지 자동 조정**: 스토리지 자동 조정 활성화 끄기 (활성화 시, 유료)



#### 연결

- **VPC**: Default

- **서브넷 그룹**: Default

- **퍼블릭 액세스**: 테스트할 때는 "예"로 해도 괜찮지만, 나중에 "아니요"로 변경해줘야함

- **VPC 보안 그룹**: 일단은 default로 하고, DB 생성한 후 보안그룹을 하나 새로 만들어 변경



#### 데이터베이스 인증

- **인증 옵션**: 암호 인증



#### 추가 구성

무료로 사용하기 위한 추가 설정

- **백업**: 자동 백업 활성화 off

- **백업 보존 기간**: 0일

- **스냅샷으로 태그 복사**: off



## 추가 설정

### 보안 그룹

RDS를 위한 보안그룹을 하나 새로 만들어준다.

- **인바운드 규칙**: MYSQL/Aurora로 두 개를 만드는데, 하나는 "내 IP주소", 다른 하나는 EC2 보안그룹의 "보안 그룹 ID"로 설정해준다.

생성했으면, 아까 만든 DB의 보안 그룹을 변경해준다.



### 한글 사용을 위한 설정

위에서 만든 DB에서 한글을 사용하기 위해서는 DB의 character-set 관련 설정을 변경해줘야 한다.



#### character-set 관련 설정

default 파라미터는 변경이 불가능하다.

1. [파라미터 그룹 → 파라미터 그룹 생성]을 클릭하여 파라미터 그룹을 하나 만들고, 파라미터를 편집한다.

2. 여기서 character-set과 관련된 항목들의 `latin1`로 되어있는 값들을 `utf8` or  `utf8mb4` or `ut8mb4-general-ci`로 변경

3. DB 인스턴스의 "DB 파라미터 그룹"을 변경

4. 재부팅

5. DB에 접속해서 확인

   ```
   show variables like 'c%';
   ```

6. 혹시 character_set_database의 파라미터 값이 latin1로 안바뀌어져 있다면, 아래 명령어를 통해 변경해주면 된다.

   ```
   ALTER DATABASE 본인db
   CHARACTER SET = 'utf8'
   COLLATE = 'utf8_general_ci';
   ```

   

## MySQL Workbench에서 접속

테이블을 보다 쉽게 확인하기 위해서 MySQL Workbench를 사용했는데, RDS에서 생성한 데이터베이스에도 접근이 가능하다.

방법은 다음과 같다.

1. Workbench의 홈화면에 있는 +버튼을 클릭하면 아래 이미지와 같은 창이 뜬다.

   <img width="800" alt="image" src="https://user-images.githubusercontent.com/70627979/176727994-b1408d1a-daca-4e63-ad24-a8ee06ec4fad.png">

2. 아래의 값들을 "RDS > 데이터베이스 > 원하는 DB 식별자" 에서 확인할 수 있는 값들로 채워넣으면 된다.

   1. **Connection Name**: [your-choice]
   2. **Hostname**: "연결 & 보안 > 엔드 포인트"
   3. **Port**: "연결 & 보안 > 포트" (보통 3306이다)
   4. **Username**: "구성 > 마스터 사용자 이름"
   5. **Password**: 생성시 설정한 마스터 암호

3. "Test Connection" 버튼을 클릭하여, 정상적으로 연결이 됐는지 확인할 수 있다.